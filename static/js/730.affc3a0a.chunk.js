(self.webpackChunkhabitual_irony=self.webpackChunkhabitual_irony||[]).push([[730],{84662:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>F});var o=n(9950),r=n(11773),i=n(89776);const l=(0,r.UM)({id:"upload",button:{name:"Upload",toolbar:!0,contextMenu:!1,icon:r.jz.upload}}),a=[(0,r.UM)({id:"view",requiresSelection:!0,fileFilter:e=>!e.isDir,button:{name:"View",toolbar:!1,contextMenu:!0,icon:r.jz.file}}),l];var c=n(16491),d=n(44414);const s=o.memo((e=>{const[t,n]=(0,o.useState)(!1),l=(0,o.useRef)(null),s=e.chonkyMap,u=()=>({baseFileMap:s.fileMap,rootFolderId:s.rootFolderId}),{fileMap:p,currentFolderId:f,setCurrentFolderId:h,deleteFiles:m,moveFiles:F,createFolder:I,createFile:C}=(()=>{const{baseFileMap:e,rootFolderId:t}=(0,o.useMemo)(u,[]),[n,r]=(0,o.useState)(e),[i,l]=(0,o.useState)(t),a=(0,o.useCallback)((()=>{r(e),l(t)}),[e,t]),c=(0,o.useRef)(i);(0,o.useEffect)((()=>{c.current=i}),[i]);const d=(0,o.useCallback)((e=>{r((t=>{const n={...t};return e.forEach((e=>{if(delete n[e.id],e.parentId){const t=n[e.parentId],o=t.childrenIds.filter((t=>t!==e.id));n[e.parentId]={...t,childrenIds:o,childrenCount:o.length}}})),n}))}),[]),s=(0,o.useCallback)(((e,t,n)=>{r((o=>{const r={...o},i=new Set(e.map((e=>e.id))),l=t.childrenIds.filter((e=>!i.has(e)));r[t.id]={...t,childrenIds:l,childrenCount:l.length};const a=[...n.childrenIds,...e.map((e=>e.id))];return r[n.id]={...n,childrenIds:a,childrenCount:a.length},e.forEach((e=>{r[e.id]={...e,parentId:n.id}})),r}))}),[]),p=(0,o.useRef)(0),f=(0,o.useCallback)((e=>{r((t=>{const n={...t},o="new-folder-".concat(p.current++);n[o]={id:o,name:e,isDir:!0,modDate:new Date,parentId:c.current,childrenIds:[],childrenCount:0};const r=n[c.current];return n[c.current]={...r,childrenIds:[...r.childrenIds,o]},n}))}),[]),h=(0,o.useCallback)((e=>{r((t=>{const n={...t},o="new-folder-".concat(p.current++);n[o]={id:o,name:e,modDate:new Date,parentId:c.current,childrenIds:[],childrenCount:0};const r=n[c.current];return n[c.current]={...r,childrenIds:[...r.childrenIds,o]},n}))}),[]);return{fileMap:n,currentFolderId:i,setCurrentFolderId:l,resetFileMap:a,deleteFiles:d,moveFiles:s,createFolder:f,createFile:h}})();(0,r.B$)({iconComponent:i.R});const b=((e,t)=>(0,o.useMemo)((()=>e[t].childrenIds.map((t=>e[t]))),[t,e]))(p,f),_=((e,t)=>(0,o.useMemo)((()=>{const n=e[t],o=[n];let r=n.parentId;for(;r;){const t=e[r];if(!t)break;o.unshift(t),r=t.parentId}return o}),[t,e]))(p,f),y=((e,t,n,i,l,a,c)=>(0,o.useCallback)((o=>{if(o.id===r.YQ.OpenFiles.id){const{targetFile:n,files:i}=o.payload,l=n||i[0];if(l&&r.FP.isDirectory(l))return void t(l.id);if(n.name.endsWith(".md")){let t=o.state.selectedFiles.map((e=>e.name)),n=e.map((e=>e.name)).join("/"),r="".concat(n,"/").concat(t);localStorage.setItem("FILE_PATH",JSON.stringify({filePath:r})),window.open("/react-project/tui-editor","_blank")}}else if(o.id===r.YQ.DeleteFiles.id)n(o.state.selectedFilesForAction);else if(o.id===r.YQ.MoveFiles.id)i(o.payload.files,o.payload.source,o.payload.destination);else if(o.id===r.YQ.CreateFolder.id){const e=prompt("Provide the name for your new folder:");e&&l(e)}else if(o.id===r.YQ.ToggleDarkMode.id)a();else if("view"===o.id){let t=o.state.selectedFiles.map((e=>e.name)),n=e.map((e=>e.name)).join("/");for(let e of t)console.log("".concat(n,"/").concat(e))}else"upload"===o.id&&c.current.click();console.log(o)}),[l,n,i,t,a]))(_,h,m,F,I,(()=>{n(!t)}),l),E=(0,o.useMemo)((()=>[...a,r.YQ.CreateFolder,r.YQ.DeleteFiles,r.YQ.ToggleDarkMode]),[]),k=(0,o.useCallback)((e=>e.thumbnailUrl?"https://chonky.io".concat(e.thumbnailUrl):null),[]);return(0,d.jsxs)(c.A,{sx:{m:2},children:[(0,d.jsx)("input",{type:"file",ref:l,accept:".json,.md",style:{display:"none"},multiple:!0,onChange:e=>(async e=>{let t=e.target.files;for(let n of t)void 0!==n&&C(n.name)})(e)}),(0,d.jsx)("div",{style:{height:400},children:(0,d.jsx)(r.I0,{files:b,folderChain:_,fileActions:E,onFileAction:y,thumbnailGenerator:k,darkMode:t,...e})})]})}));var u=n(12035),p=n(9210),f=n.n(p);const h=f().AES.decrypt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_KAKAO_KEY:"28893c40e75d5ff4f79fe0cedabb2f2b",REACT_APP_API_URL:"https://port-0-back-api-128y2k2llvhomk0i.sel5.cloudtype.app",REACT_APP_URL:"https://habitual-irony.github.io",REACT_APP_GH_TOKEN:"U2FsdGVkX192g068G+4lZ/awUwT2q7/4TgycUOB3KIjP3+9AfFNAxSDV1FpfgHzYsUfy+jS2TSm4KCK+2EObCg=="}.REACT_APP_MY_TOKEN,"MY_SECRET_KEY").toString(f().enc.Utf8),m="test_repo",F=()=>{const[e,t]=(0,o.useState)(void 0),n=async()=>{let e=await(async e=>{try{const t=new u.E({auth:h}),n=await t.request("GET /repos/habitual-irony/".concat(m,"/contents/").concat(e),{repo:"".concat(m),path:"".concat(e),encoding:"utf-8",decoding:"utf-8"});return decodeURIComponent(escape(window.atob(n.data.content)))}catch(t){return}})("actions/config/chonky_map.json");if(void 0===e)return;let n=JSON.parse(e);t(n)};return(0,o.useEffect)((()=>{n()}),[]),(0,d.jsx)("div",{children:e&&(0,d.jsx)(s,{chonkyMap:e})})}},72858:()=>{}}]);